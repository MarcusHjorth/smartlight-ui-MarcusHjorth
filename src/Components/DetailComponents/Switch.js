import React, { useState, useEffect } from 'react';
import axios from "axios";
import { useParams } from 'react-router-dom';

const Switch = () => {
    const URL = "http://192.168.8.100/api/TtxPSfr7mK8-5hShghYZ8e4EvjzkNuAHRvu1jm9h"
    const SingleLight = URL + "/lights/52/state"
    const GroupLights = URL + "/groups/"

    const [ rooms, setRooms ] = useState()
    const { id } = useParams()
    const [ on, setOn ] = useState(null)


    useEffect(() => {
        axios({
            url: GroupLights + id  + "/action",
            method: "PUT",
            data: {
                on,
            }
        }).then(request => { 
            setRooms(request.data)
        })
    }, [ on ])

    useEffect(() => {
        axios({
            url: GroupLights + id,
            method: "GET",
            data: {
                on,
            }
        })
        .then((res ) => {
            setOn(res.data.state.on)
        })
    }, [])


    return ( 
        <button className="bg-white w-8 h-8 flex justify-center items-center absolute rounded-full cursor-pointer top-[-15px] right-[20px] shadow-md"
            onClick={ ()=> setOn(!on) }>
            <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M14.83 2.69999C16.3418 3.77943 17.4716 5.31116 18.0565 7.07424C18.6414 8.83732 18.6512 10.7406 18.0845 12.5096C17.5178 14.2787 16.4038 15.8219 14.9032 16.9169C13.4027 18.0118 11.5931 18.6019 9.73551 18.6019C7.87793 18.6019 6.06835 18.0118 4.56779 16.9169C3.06723 15.8219 1.95324 14.2787 1.3865 12.5096C0.819763 10.7406 0.829564 8.83732 1.41449 7.07424C1.99942 5.31116 3.12925 3.77943 4.64101 2.69999C4.73805 2.6303 4.84868 2.58182 4.96569 2.55771C5.08271 2.5336 5.20349 2.5344 5.32018 2.56006C5.43687 2.58572 5.54684 2.63566 5.64295 2.70663C5.73906 2.7776 5.81915 2.86802 5.87801 2.97199L6.43701 3.96499C6.53922 4.14516 6.57196 4.35651 6.52903 4.55916C6.48611 4.76181 6.37049 4.94174 6.20401 5.06499C5.19958 5.80851 4.45528 6.84992 4.07705 8.04098C3.69883 9.23205 3.70595 10.5121 4.09741 11.6989C4.48887 12.8856 5.24471 13.9187 6.25735 14.651C7.27 15.3833 8.48783 15.7775 9.73751 15.7775C10.9872 15.7775 12.205 15.3833 13.2177 14.651C14.2303 13.9187 14.9861 12.8856 15.3776 11.6989C15.7691 10.5121 15.7762 9.23205 15.398 8.04098C15.0197 6.84992 14.2754 5.80851 13.271 5.06499C13.1062 4.94229 12.9918 4.76359 12.9494 4.5625C12.9071 4.36141 12.9397 4.15177 13.041 3.97299L13.6 2.97999C13.6581 2.87626 13.7375 2.78593 13.8328 2.71488C13.9282 2.64383 14.0374 2.59366 14.1534 2.56762C14.2695 2.54159 14.3897 2.54028 14.5062 2.56377C14.6228 2.58727 14.7331 2.63504 14.83 2.70399V2.69999ZM11.154 10.121V1.63599C11.1544 1.52473 11.1328 1.41447 11.0906 1.31155C11.0483 1.20863 10.9861 1.11506 10.9076 1.03619C10.8291 0.957331 10.7359 0.894726 10.6331 0.851964C10.5304 0.809202 10.4203 0.787123 10.309 0.786993H9.17401C9.0624 0.786596 8.95182 0.808286 8.84864 0.850811C8.74545 0.893337 8.6517 0.955859 8.57279 1.03477C8.49387 1.11369 8.43135 1.20744 8.38882 1.31063C8.3463 1.41381 8.32461 1.52439 8.32501 1.63599V10.121C8.32461 10.2326 8.3463 10.3432 8.38882 10.4464C8.43135 10.5495 8.49387 10.6433 8.57279 10.7222C8.6517 10.8011 8.74545 10.8636 8.84864 10.9062C8.95182 10.9487 9.0624 10.9704 9.17401 10.97H10.309C10.4203 10.9699 10.5304 10.9478 10.6331 10.905C10.7359 10.8623 10.8291 10.7997 10.9076 10.7208C10.9861 10.6419 11.0483 10.5484 11.0906 10.4454C11.1328 10.3425 11.1544 10.2323 11.154 10.121Z" fill="#FF9696"/>
            </svg>
        </button>
     );
}
 
export default Switch;